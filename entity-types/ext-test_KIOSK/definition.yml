id: kiosk
name: Kiosk Device
domain: EXT
type: KIOSK
configuration:
  entityExpirationTime: EIGHT_DAYS
synthesis:
  rules:
    - identifier: kiosk.id
      name: kiosk.id
      encodeIdentifierInGUID: true
      group_by: kiosk.id
      conditions:
        #- attribute: hostname
        #  matches: ".*KIOSK.*" #matches is not supported
        - attribute: device.type
          value: "CSO" # May be KIOSK in the future
        - attribute: newrelic.source
          value: "api.logs"
        - attribute: country
          present: true
        - attribute: store.number
          present: true
        - attribute: device.number
          present: true
      tags:
        hostname:
          multiValue: false
        country:
          multiValue: false
          ttl: 7D
        store.number:
          multiValue: false
          ttl: 7D
        device.type:
          multiValue: false
          ttl: 7D
        device.number:
          multiValue: false
          ttl: 7D
        geo.location.lon:
          multiValue: false
          ttl: 7D
        geo.location.lat:
          multiValue: false
          ttl: 7D
        host.ip:
          multiValue: false
          ttl: 7D

# This relationshop code is not correct
related_entities:
  - type: STORE
    direction: SOURCE
    conditions:
      - attribute: store.number
        matches: "{{ entity.store.number }}"


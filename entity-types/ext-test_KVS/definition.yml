id: kvs
name: Kitchen Video System
domain: EXT
type: KVS
configuration:
  entityExpirationTime: EIGHT_DAYS
synthesis:
  rules:
    - identifier: kvs.id
      name: kvs.id
      encodeIdentifierInGUID: true
      group_by: kvs.id
      conditions:
        #- attribute: hostname 
        #  matches: ".*KVS.*"   # "match" not supported
        - attribute: device.type
          value: "KVS"
        - attribute: newrelic.source
          value: "api.logs"
        - attribute: country
          present: true
        - attribute: store.number
          present: true
        - attribute: device.number
          present: true
      tags:
        hostname:
          multiValue: false
        country:
          multiValue: false
          ttl: 7D
        store.number:
          multiValue: false
          ttl: 7D
        device.type:
          multiValue: false
          ttl: 7D
        device.number:
          multiValue: false
          ttl: 7D
        geo.location.lon:
          multiValue: false
          ttl: 7D
        geo.location.lat:
          multiValue: false
          ttl: 7D
        host.ip:
          multiValue: false
          ttl: 7D

# This relationshop code is not correct
related_entities:
  - type: STORE
    direction: SOURCE
    conditions:
      - attribute: store.number
        matches: "{{ entity.store.number }}"

